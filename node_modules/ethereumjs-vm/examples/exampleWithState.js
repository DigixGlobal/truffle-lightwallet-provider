const Trie = require('merkle-patricia-tree')
const Account = require('ethereumjs-account')
const Tx = require('ethereumjs-tx')
const ethUtil = require('ethereumjs-util')
const VM = require('../index')

// the private/public key pair. used to sign the transactions and generate the addresses
const secretKey = '3cd7232cd6f3fc66a57a6bedc1a8ed6c228fff0a327e169c2bcc5e869ed49511'
const publicKey = '0406cc661590d48ee972944b35ad13ff03c7876eae3fd191e8a2f77311b0a3c6613407b5005e63d7d8d76b89d5f900cde691497688bb281e07a5052ff61edebdc0'
const address = ethUtil.pubToAddress(new Buffer(publicKey, 'hex'), true)

const state = new Trie()
// give the aboce address some money :)
state.put(address, new Account({
  balance: 50000,
  nonce: 0
}).serialize())

const vm = new VM({state: state})

// create a new tx
const tx = new Tx({
  nonce: '0x01',
  gasPrice: '0x09184e72a000',
  gasLimit: '0x20710',
  value: '0x10',
  to: '0x692a70d2e424a56d2c6c27aa97d1a86395877b3a'
})

console.log(tx);

vm.runTx(tx, () => {
  console.log()
})
